<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout :: layout('Inscription', ~{::section})}">
<section class="stack">
  <div class="card">
    <h1 class="h1">Inscription</h1>

    <form class="form" th:action="@{/inscription}" method="post" id="formInscription">
      <div class="grid grid--2">
        <div class="field">
          <label for="role">Type de compte</label>
          <select id="role" name="role" required>
            <option value="" th:selected="${role == null || role == ''}">— Sélectionner —</option>
            <option value="AGENT" th:selected="${role == 'AGENT'}">Agent</option>
            <option value="LOUEUR" th:selected="${role == 'LOUEUR'}">Loueur</option>
            <option value="ENTRETIEN" th:selected="${role == 'ENTRETIEN'}">Entreprise d’entretien</option>
          </select>
        </div>

        <div class="field">
          <label for="email">Email</label>
          <input id="email" type="email" name="email" th:value="${email}" required />
        </div>

        <div class="field">
          <label for="password">Mot de passe</label>
          <input id="password" type="password" name="password" required />
        </div>

        <div class="field">
          <label for="telephone">Téléphone</label>
          <input id="telephone" type="text" name="telephone" th:value="${telephone}" required />
        </div>
      </div>

      <hr class="sep" />

      <h2 class="h2">Adresse</h2>
      <div class="grid grid--2">
        <div class="field grid--full">
          <label for="adresse">Adresse</label>
          <input id="adresse" type="text" name="adresse" th:value="${adresse}" required />
        </div>

        <div class="field">
          <label for="ville">Ville</label>
          <input id="ville" type="text" name="ville" th:value="${ville}" required />
        </div>

        <div class="field">
          <label for="codePostal">Code postal</label>
          <input id="codePostal" type="text" name="codePostal" th:value="${codePostal}" required />
        </div>

        <div class="field">
          <label for="region">Région</label>
          <input id="region" type="text" name="region" th:value="${region}" required />
        </div>
      </div>

      <hr class="sep" />

      <div id="blocPersonne">
        <h2 class="h2">Identité (Agent / Loueur)</h2>
        <div class="grid grid--2">
          <div class="field">
            <label for="prenom">Prénom</label>
            <input id="prenom" type="text" name="prenom" th:value="${prenom}" />
          </div>
          <div class="field">
            <label for="nom">Nom</label>
            <input id="nom" type="text" name="nom" th:value="${nom}" />
          </div>
        </div>
      </div>

      <div id="blocEntretien">
        <h2 class="h2">Entreprise d’entretien</h2>
        <div class="grid grid--2">
          <div class="field">
            <label for="nomEntreprise">Nom d’entreprise</label>
            <input id="nomEntreprise" type="text" name="nomEntreprise" th:value="${nomEntreprise}" />
          </div>
          <div class="field">
            <label for="raisonSociale">Raison sociale</label>
            <input id="raisonSociale" type="text" name="raisonSociale" th:value="${raisonSociale}" />
          </div>
          <div class="field">
            <label for="siret">SIRET</label>
            <input id="siret" type="text" name="siret" th:value="${siret}" />
          </div>
        </div>
      </div>

      <div class="actions">
        <button class="btn btn--primary" type="submit">Créer le compte</button>
        <a class="btn" th:href="@{/connexion}">Déjà un compte</a>
      </div>
    </form>
  </div>

  <script>
    (function () {
      const role = document.getElementById('role');
      const blocPersonne = document.getElementById('blocPersonne');
      const blocEntretien = document.getElementById('blocEntretien');

      function update() {
        const v = role.value;
        const isEntretien = (v === 'ENTRETIEN');
        blocEntretien.style.display = isEntretien ? '' : 'none';
        blocPersonne.style.display = isEntretien ? 'none' : '';
      }

      role.addEventListener('change', update);
      update();
    })();
  </script>
</section>
</html>